(self["webpackChunkfront"]=self["webpackChunkfront"]||[]).push([[898],{7045:function(e,t,n){var o=n(6339),i=n(3070);e.exports=function(e,t,n){return n.get&&o(n.get,t,{getter:!0}),n.set&&o(n.set,t,{setter:!0}),i.f(e,t,n)}},2062:function(e,t,n){"use strict";var o=n(9781),i=n(1702),l=n(7045),a=URLSearchParams.prototype,s=i(a.forEach);o&&!("size"in a)&&l(a,"size",{get:function(){var e=0;return s(this,(function(){e++})),e},configurable:!0,enumerable:!0})},4057:function(e,t,n){"use strict";n.d(t,{Z:function(){return w}});var o=n(3396),i=n(7139);const l={id:"clientFileListComponent"},a=(0,o._)("h2",{style:{"margin-bottom":"30px"}},"Vos fichiers",-1),s={id:"clientFileList"},r={class:"list-group"},u={class:"fileRowText"},d={id:"fileRowTextName"},m={class:"fileRowButtons"},c=["onClick"],p=["onClick"],f=["onClick"];function h(e,t,n,h,_,v){const b=(0,o.up)("client-new-file-form");return(0,o.wg)(),(0,o.iD)("div",l,[a,(0,o._)("div",s,[(0,o._)("ul",r,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(_.userFiles,(e=>((0,o.wg)(),(0,o.iD)("li",{class:"fileRow list-group-item",key:e.name},[(0,o._)("div",u,[(0,o._)("span",d,(0,i.zw)(e.nom_document),1),(0,o._)("span",null,(0,i.zw)(e.type),1)]),(0,o._)("div",m,[(0,o._)("button",{class:"btn btn-success fileRowButton",onClick:()=>v.handleDownload(e.id_document,e.nom_document)},"Télécharger",8,c),(0,o._)("button",{class:"btn btn-light fileRowButton",onClick:()=>v.handleUpdate(e.id_document)},"Remplacer",8,p),(0,o._)("button",{class:"btn btn-danger fileRowButton",onClick:()=>v.handleDelete(e.id_document)},"Supprimer",8,f)])])))),128))])]),(0,o.Wm)(b)])}n(2062),n(7658);var _=n(3171),v={components:{ClientNewFileForm:_.Z},name:"ClientFileList",data(){return{userFiles:[]}},methods:{handleDownload(e,t){console.log(e),fetch(this.api_url+"document/downloadDocument/"+e,{method:"GET",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}}).then((e=>{if(e.ok)return e.blob();throw new Error("Something went wrong")})).then((e=>{console.log(e);const n=window.URL.createObjectURL(new Blob([e])),o=document.createElement("a");o.href=n,o.setAttribute("download",t),document.body.appendChild(o),o.click()}))},handleUpdate(e){let t=this;console.log(e);const n=document.createElement("input");n.type="file",n.ref="file",n.click(),n.onchange=()=>{const o=new FormData;console.log(n),o.append("file",n.files[0]);let i=new XMLHttpRequest;i.open("PATCH",this.api_url+"document/updateDocument/"+e,!0),i.setRequestHeader("Authorization",localStorage.getItem("token")),i.send(o),i.onload=function(){200==i.status?(console.log("File uploaded"),t.userFiles.find((t=>t.id_document===e)).nom_document=n.files[0].name,t.$notify({title:"Succès",text:"Votre fichier a été mis à jour",type:"success"})):(console.log("Error "+i.status+" occurred when trying to upload your file."),this.$notify({title:"Erreur",text:"Une erreur est survenue lors de la mise à jour de votre fichier",type:"error"}))}}},handleDelete(e){confirm("Voulez-vous vraiment supprimer ce fichier ?")&&(console.log(e),fetch(this.api_url+"document/deleteDocument/"+e,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}}).then((e=>{if(e.ok)return e.json();throw new Error("Une erreur est survenue lors de la suppression de votre fichier")})).then((t=>{console.log(t),this.userFiles=this.userFiles.filter((t=>t.id_document!==e)),this.$notify({title:"Succès",text:"Votre fichier a été supprimé",type:"success"})})).catch((e=>{console.log(e),this.$notify({title:"Erreur",text:"Une erreur est survenue lors de la suppression de votre fichier",type:"error"})})))},fetchUserFiles(){fetch(this.api_url+"document/getAllDocuments",{method:"GET",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}}).then((e=>{if(e.ok)return e.json();if(401!=e.status)throw new Error("Une erreur est survenue lors de la récupération de vos fichiers");this.$router.push("/login")})).then((e=>{console.log(e),this.userFiles=e;for(let t=0;t<this.userFiles.length;t++)null==this.userFiles[t].type&&(this.userFiles[t].type="Non spécifié")})).catch((e=>{console.log(e),this.$notify({title:"Erreur",text:"Une erreur est survenue lors de la récupération de vos fichiers",type:"error"})}))}},mounted(){this.fetchUserFiles()}},b=n(89);const D=(0,b.Z)(v,[["render",h]]);var w=D},3171:function(e,t,n){"use strict";n.d(t,{Z:function(){return D}});var o=n(3396),i=n(9242);const l={key:0,id:"modal-file-form",ref:"modalForm"},a=(0,o._)("h2",null,"Nouveau document",-1),s={class:"mb-3"},r=(0,o._)("label",{for:"formFile",class:"form-label"},"Votre fichier",-1),u={class:"mb-3"},d=(0,o._)("label",{for:"formNameTitle",class:"form-label"},"Nom du fichier",-1),m={class:"mb-3"},c=(0,o._)("label",{for:"formDocType",class:"form-label"},"Genre",-1),p=(0,o.uE)('<option value="">Selectionnez le type du fichier</option><option value="Document d&#39;identité">Document d&#39;identité</option><option value="Fiche de paie">Fiche de paie</option><option value="Document médical">Document médical</option><option value="Justificatif de domicile">Justificatif de domicile</option><option value="Autre">Autre</option>',6),f=[p];function h(e,t,n,p,h,_){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("button",{type:"none",id:"openNFButton",onClick:t[0]||(t[0]=()=>_.handleDisplay())},"NOUVEAU DOCUMENT"),h.displayForm?((0,o.wg)(),(0,o.iD)("div",l,[(0,o._)("button",{id:"closeButton",onClick:t[1]||(t[1]=()=>_.handleDisplay())},"X"),a,(0,o._)("form",null,[(0,o._)("div",s,[r,(0,o._)("input",{class:"form-control",type:"file",id:"formFile",onChange:t[2]||(t[2]=e=>_.onFilesChange(e)),required:""},null,32)]),(0,o._)("div",u,[d,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formNameTitle","onUpdate:modelValue":t[3]||(t[3]=e=>h.name=e),placeholder:"Nom du fichier",maxlength:"30",required:""},null,512),[[i.nr,h.name]])]),(0,o._)("div",m,[c,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formDocType","onUpdate:modelValue":t[4]||(t[4]=e=>h.type=e)},f,512),[[i.bM,h.type]])]),(0,o._)("button",{type:"submit",class:"btn btn-success",onClick:t[5]||(t[5]=e=>_.handleSubmit(e))},"Envoyer"),(0,o._)("button",{type:"none",class:"btn btn-warning",onClick:t[6]||(t[6]=()=>_.handleDisplay())},"Annuler")])],512)):(0,o.kq)("",!0)])}n(7658);var _={name:"ClientNewFileForm",data(){return{name:"",file:null,displayForm:!1,type:""}},methods:{onFilesChange(e){this.file=e.target.files[0]},handleSubmit(e){if(""==this.name||null==this.file||""==this.type)return;e.preventDefault();let t=new FormData;t.append("file",this.file),t.append("nom_document",this.name),t.append("type",this.type);let n=new XMLHttpRequest;n.open("POST",this.api_url+"document/addDocument"),n.setRequestHeader("Authorization",localStorage.getItem("token")),n.send(t),n.onload=()=>{if(200==n.status){let e=JSON.parse(n.response);console.log("File sent"),console.log(e.id_document),this.$parent.userFiles.push({nom_document:this.name+"."+this.file.name.split(".").pop(),id_document:e.id_document,type:this.type}),this.name="",this.file=null,this.type="",this.displayForm=!1,this.$notify({title:"Succès",text:"Votre document a bien été envoyé",type:"success"})}else console.log("Error while sending file"),this.$notify({title:"Erreur",text:"Une erreur est survenue lors de l'envoi du document",type:"error"})}},handleDisplay(){console.log("display"),this.displayForm=!this.displayForm}}},v=n(89);const b=(0,v.Z)(_,[["render",h]]);var D=b},7898:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return gn}});var o=n(3396),i=n(7139);const l={id:"main-body"},a={id:"body-left"},s={id:"profile-overview-area"},r=(0,o._)("h2",null,"Votre profil :",-1),u={id:"profile-list",class:"section-list"},d={class:"profile-item"},m=(0,o._)("span",null,"Nom :",-1),c={class:"profile-item"},p=(0,o._)("span",null,"Prénom :",-1),f={class:"profile-item"},h=(0,o._)("span",null,"Date de Naissance :",-1),_={class:"profile-item"},v=(0,o._)("span",null,"Numéro de téléphone :",-1),b={class:"profile-item"},D=(0,o._)("span",null,"Adresse mail :",-1),w={class:"profile-item"},y=(0,o._)("span",null,"Profession :",-1),g={class:"profile-item profile-buttons"},C={id:"notifications-view-area"},A=(0,o._)("h2",null,"Vos notifications :",-1),z={id:"notifications-list",class:"section-list"},F={id:"body-right"},x={id:"demands-overview-area"},k=(0,o._)("h2",null,"Liste de vos demandes en cours :",-1),V={id:"demands-list",class:"section-list"},j={id:"add-demand-area"};function E(e,t,n,E,U,q){const T=(0,o.up)("HeaderComponent"),S=(0,o.up)("client-file-list-modal"),N=(0,o.up)("router-link"),$=(0,o.up)("client-notification-list-element"),R=(0,o.up)("client-demands-list-element"),L=(0,o.up)("ClientDemandForm");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(T),(0,o._)("div",l,[(0,o._)("div",a,[(0,o._)("div",s,[r,(0,o._)("ul",u,[(0,o._)("li",d,[m,(0,o._)("span",null,(0,i.zw)(U.userData.nom),1)]),(0,o._)("li",c,[p,(0,o._)("span",null,(0,i.zw)(U.userData.prenom),1)]),(0,o._)("li",f,[h,(0,o._)("span",null,(0,i.zw)(U.userData.date_birth),1)]),(0,o._)("li",_,[v,(0,o._)("span",null,(0,i.zw)(U.userData.tel),1)]),(0,o._)("li",b,[D,(0,o._)("span",null,(0,i.zw)(U.userData.email),1)]),(0,o._)("li",w,[y,(0,o._)("span",null,(0,i.zw)(U.userData.situation_professionnelle),1)]),(0,o._)("li",g,[(0,o.Wm)(S),(0,o.Wm)(N,{class:"btn btn-primary",to:"/client/profile"},{default:(0,o.w5)((()=>[(0,o.Uk)("Votre profil")])),_:1})])])]),(0,o._)("div",C,[A,(0,o._)("ul",z,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(U.userNotifications,(e=>((0,o.wg)(),(0,o.j4)($,{key:e.id,notification:e},null,8,["notification"])))),128))])])]),(0,o._)("div",F,[(0,o._)("div",x,[k,(0,o._)("ul",V,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(U.userDemands,(e=>((0,o.wg)(),(0,o.j4)(R,{key:e.id_demande,demand:e},null,8,["demand"])))),128))])]),(0,o._)("div",j,[(0,o.Wm)(L,{id:"demand-form"})])])])])}n(7658);var U=n(9242);const q={key:0,id:"modal-form",ref:"modalForm"},T=(0,o._)("h2",null,"Nouvelle demande",-1),S={id:"demandCreationForm"},N={id:"demandCreationFormFields"},$={class:"mb-3"},R=(0,o._)("label",{for:"formSubject",class:"form-label"},"Sujet",-1),L={class:"mb-3"},M=(0,o._)("label",{for:"formNature",class:"form-label"},"Nature du projet ?",-1),I=(0,o.uE)('<option value="">Choisissez la nature de votre projet</option><option value="Achat">Achat</option><option value="Construction">Construction</option><option value="Travaux">Travaux</option><option value="Autre">Autre</option>',5),Z=[I],O={class:"mb-3"},H=(0,o._)("label",{for:"formType",class:"form-label"},"Type de bien ?",-1),B=(0,o.uE)('<option value="">Choisissez le type du bien</option><option value="Maison">Maison</option><option value="Appartement">Appartement</option><option value="Terrain">Terrain</option><option value="Autre">Autre</option>',5),P=[B],G={class:"mb-3"},W=(0,o._)("label",{for:"formAge",class:"form-label"},"Age du bien ?",-1),J=(0,o._)("option",{value:""},"Choisissez l'âge du bien",-1),X=(0,o._)("option",{value:"Ancien"},"Ancien",-1),K=(0,o._)("option",{value:"Neuf"},"Neuf",-1),Y=(0,o._)("option",{value:"Vente sur plan"},"Vente sur plan",-1),Q=[J,X,K,Y],ee={class:"mb-3"},te=(0,o._)("label",{for:"formPurpose",class:"form-label"},"Usage du bien ?",-1),ne=(0,o.uE)('<option value="">Choisissez l&#39;usage du bien</option><option value="Résidence principale">Résidence principale</option><option value="Résidence secondaire">Résidence secondaire</option><option value="Investissement locatif">Investissement locatif</option><option value="Usage professionnel">Usage professionnel</option><option value="Usage mixte">Usage mixte</option><option value="Autre">Autre</option>',7),oe=[ne],ie={class:"mb-3"},le=(0,o._)("label",{for:"formResearchStatus",class:"form-label"},"Ou en êtes vous dans votre recherche ?",-1),ae=(0,o.uE)('<option value="">Renseigner où vous en êtes dans votre recherche</option><option value="En recherche">En recherche</option><option value="Vous vous préparez à faire une offre">Vous vous préparez à faire une offre</option><option value="Vous avez déjà fait une offre">Vous avez déjà fait une offre</option><option value="Vous pensez bientôt signer compromi">Vous pensez bientôt signer compromis</option><option value="Vous avez déjà signé un compromis">Vous avez déjà signé un compromis</option><option value="Autre">Autre</option>',7),se=[ae],re={class:"mb-3"},ue=(0,o._)("label",{for:"formCountry",class:"form-label"},"Dans quel pays se situe le bien ?",-1),de={class:"mb-3"},me=(0,o._)("label",{for:"formCity",class:"form-label"},"Dans quelle ville se situe le bien ?",-1),ce={class:"mb-3"},pe=(0,o._)("label",{for:"formAcquisitionAmount",class:"form-label"},"Montant estimé de l'acquisition ?",-1),fe={class:"mb-3"},he=(0,o._)("label",{for:"formTravauxAmount",class:"form-label"},"Montant estimé des travaux ?",-1),_e={class:"mb-3"},ve=(0,o._)("label",{for:"formNotaireAmount",class:"form-label"},"Frais de notaire ? (optionnel)",-1),be={class:"mb-3"},De=(0,o._)("label",{for:"formAloneGroup",class:"form-label"},"Comment empruntez-vous ?",-1),we=(0,o._)("option",{value:""},"Vous empruntez seul ? En groupe ? ",-1),ye=(0,o._)("option",{value:"1"},"Seul",-1),ge=(0,o._)("option",{value:"2"},"Avec un co-emprunteur",-1),Ce=(0,o._)("option",{value:"3"},"Autre",-1),Ae=[we,ye,ge,Ce],ze={class:"mb-3"},Fe=(0,o._)("label",{for:"formApport",class:"form-label"},"Votre apport personnel ?",-1),xe={class:"mb-3"},ke=(0,o._)("label",{for:"formComment",class:"form-label"},"Commentaires sur le projet ? (optionnel)",-1),Ve={class:"mb-3"},je=(0,o._)("label",{for:"formFileMultiple",class:"form-label"},"Vos Fichiers",-1);function Ee(e,t,n,i,l,a){const s=(0,o.up)("ClientFileListCheckableElement"),r=(0,o.up)("client-new-file-form");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("button",{id:"openButton",onClick:t[0]||(t[0]=()=>a.handleDisplay())},"NOUVELLE DEMANDE"),l.displayForm?((0,o.wg)(),(0,o.iD)("div",q,[(0,o._)("button",{id:"closeButton",onClick:t[1]||(t[1]=()=>a.handleDisplay())},"X"),T,(0,o._)("form",S,[(0,o._)("div",N,[(0,o._)("div",$,[R,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formSubject","onUpdate:modelValue":t[2]||(t[2]=e=>l.newDemand.sujet=e),placeholder:"Trouvez un titre pour votre demande",required:""},null,512),[[U.nr,l.newDemand.sujet]])]),(0,o._)("div",L,[M,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formNature","onUpdate:modelValue":t[3]||(t[3]=e=>l.newDemand.nature=e),required:""},Z,512),[[U.bM,l.newDemand.nature]])]),(0,o._)("div",O,[H,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formType","onUpdate:modelValue":t[4]||(t[4]=e=>l.newDemand.type=e),required:""},P,512),[[U.bM,l.newDemand.type]])]),(0,o._)("div",G,[W,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formAge","onUpdate:modelValue":t[5]||(t[5]=e=>l.newDemand.age=e),required:""},Q,512),[[U.bM,l.newDemand.age]])]),(0,o._)("div",ee,[te,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formPurpose","onUpdate:modelValue":t[6]||(t[6]=e=>l.newDemand.usage=e),required:""},oe,512),[[U.bM,l.newDemand.usage]])]),(0,o._)("div",ie,[le,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formResearchStatus","onUpdate:modelValue":t[7]||(t[7]=e=>l.newDemand.status_recherche=e),required:""},se,512),[[U.bM,l.newDemand.status_recherche]])]),(0,o._)("div",re,[ue,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formCountry","onUpdate:modelValue":t[8]||(t[8]=e=>l.newDemand.pays=e),placeholder:"Renseignez le pays où se situe le bien",required:""},null,512),[[U.nr,l.newDemand.pays]])]),(0,o._)("div",de,[me,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formCity","onUpdate:modelValue":t[9]||(t[9]=e=>l.newDemand.ville=e),placeholder:"Renseignez la ville où se situe le bien",required:""},null,512),[[U.nr,l.newDemand.ville]])]),(0,o._)("div",ce,[pe,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formAcquisitionAmount","onUpdate:modelValue":t[10]||(t[10]=e=>l.newDemand.montant_bien=e),placeholder:"Renseignez la valeur estimée du bien",required:""},null,512),[[U.nr,l.newDemand.montant_bien]])]),(0,o._)("div",fe,[he,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formTravauxAmount","onUpdate:modelValue":t[11]||(t[11]=e=>l.newDemand.montant_travaux=e),placeholder:"Renseignez la valeur estimée des travaux",required:""},null,512),[[U.nr,l.newDemand.montant_travaux]])]),(0,o._)("div",_e,[ve,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formNotaireAmount","onUpdate:modelValue":t[12]||(t[12]=e=>l.newDemand.frais_notaire=e),placeholder:"Renseignez les frais de notaires, si il y a"},null,512),[[U.nr,l.newDemand.frais_notaire]])]),(0,o._)("div",be,[De,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formAloneGroup","onUpdate:modelValue":t[13]||(t[13]=e=>l.newDemand.accompagnement=e),required:""},Ae,512),[[U.bM,l.newDemand.accompagnement]])]),(0,o._)("div",ze,[Fe,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formApport","onUpdate:modelValue":t[14]||(t[14]=e=>l.newDemand.apport_personnel=e),placeholder:"Renseignez votre apport dans l'acquisition",required:""},null,512),[[U.nr,l.newDemand.apport_personnel]])]),(0,o._)("div",xe,[ke,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formComment","onUpdate:modelValue":t[15]||(t[15]=e=>l.newDemand.commentaire=e),placeholder:"Vous pouvez ajouter tout détail que vous pensez significant"},null,512),[[U.nr,l.newDemand.commentaire]])]),(0,o._)("div",Ve,[je,(0,o._)("ul",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.userFiles,(e=>((0,o.wg)(),(0,o.j4)(s,{key:e.id_document,file:e},null,8,["file"])))),128))]),(0,o.Wm)(r)])]),(0,o._)("button",{type:"submit",class:"btn btn-primary",onClick:t[16]||(t[16]=e=>a.handleSubmit(e))},"Envoyer")])],512)):(0,o.kq)("",!0)])}const Ue={id:"checkableRow"},qe=["id","name"],Te=["for"],Se=(0,o._)("br",null,null,-1);function Ne(e,t,n,l,a,s){return(0,o.wg)(),(0,o.iD)("div",Ue,[(0,o._)("input",{type:"checkbox",id:n.file.id_document,ref:n.file.id_document,name:n.file.id,value:"Bike",onChange:t[0]||(t[0]=e=>s.handleAddFile(e))},null,40,qe),(0,o._)("label",{for:n.file.id},(0,i.zw)(n.file.nom_document)+" ["+(0,i.zw)(n.file.type)+"]",9,Te),Se])}var $e={name:"ClientFileListCheckableElement",props:{file:{type:Object,required:!0}},methods:{handleAddFile(e){e.target.checked?this.$parent.newDemand.files.push(this.file.id_document):this.$parent.newDemand.files=this.$parent.newDemand.files.filter((e=>e!==this.file.id_document)),console.log(this.$parent.newDemand.files)}},updated(){void 0==this.$parent.newDemand.files&&(this.$parent.newDemand.files=[]),this.$parent.newDemand.files.includes(this.file.id_document)?this.$refs[this.file.id_document].checked=!0:this.$refs[this.file.id_document].checked=!1},mounted(){void 0==this.$parent.newDemand.files&&(this.$parent.newDemand.files=[]),this.$parent.newDemand.files.includes(this.file.id_document)?this.$refs[this.file.id_document].checked=!0:this.$refs[this.file.id_document].checked=!1}},Re=n(89);const Le=(0,Re.Z)($e,[["render",Ne]]);var Me=Le,Ie=n(3171),Ze={name:"ClientDemandForm",data(){return{newDemand:{sujet:"",nature:"",type:"",age:"",usage:"",status_recherche:"",pays:"",ville:"",montant_bien:"",montant_travaux:"",frais_notaire:"",accompagnement:"",apport_personnel:"",commentaire:"",files:[]},displayForm:!1,userFiles:[]}},methods:{handleSubmit(e){if(""==this.newDemand.sujet||""==this.newDemand.nature||""==this.newDemand.type||""==this.newDemand.age||""==this.newDemand.usage||""==this.newDemand.status_recherche||""==this.newDemand.pays||""==this.newDemand.montant_bien||""==this.newDemand.accompagnement||""==this.newDemand.apport_personnel)return void this.$notify({title:"Erreur",text:"Veuillez remplir tous les champs obligatoires",type:"error"});e.preventDefault();let t=["Document d'identité","Fiche de paie","Document médical","Justificatif de domicile"],n=[],o=[];for(let i=0;i<this.userFiles.length;i++)-1!=this.newDemand.files.findIndex((e=>e==this.userFiles[i].id_document))&&n.push(this.userFiles[i].type);for(let i=0;i<t.length;i++)-1==n.findIndex((e=>e==t[i]))&&o.push(t[i]);o.length>0&&!confirm("Attention ! Les fichiers suivants sont manquants : \n-"+o.join("\n-")+"\nVoulez-vous continuer ?")||(console.log(localStorage.getItem("token")),fetch(this.api_url+"demande_client/createDemande",{method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")},body:JSON.stringify(this.newDemand)}).then((e=>{if(e.ok)return e.json();throw new Error("Something went wrong")})).then((e=>{console.log(e);let t=this.newDemand;t.id_demande=e.id_demande,this.$parent.userDemands.push(this.newDemand),console.log(this.$parent.userDemands),this.newDemand={sujet:"",nature:"",type:"",age:"",usage:"",status_recherche:"",pays:"",ville:"",montant_bien:"",montant_travaux:"",frais_notaire:"",accompagnement:"",apport_personnel:"",commentaire:"",files:[]},this.$notify({title:"Demande envoyée",text:"Votre demande a bien été envoyée",type:"success"}),this.handleDisplay()})).catch((e=>{console.log(e),this.$notify({title:"Erreur",text:"Une erreur est survenue, veuillez réessayer plus tard",type:"error"})})))},handleDisplay(){this.displayForm=!this.displayForm}},components:{ClientFileListCheckableElement:Me,ClientNewFileForm:Ie.Z},mounted(){fetch(this.api_url+"document/getAllDocuments",{method:"GET",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}}).then((e=>{if(e.ok)return e.json();throw new Error("Il y a eu un problème lors de la récupération des documents")})).then((e=>{console.log(e),this.userFiles=e})).catch((e=>{console.log(e),this.$notify({title:"Erreur",text:e.message,type:"error"})}))}};const Oe=(0,Re.Z)(Ze,[["render",Ee]]);var He=Oe,Be=n(9222);const Pe={id:"notificationListElement"},Ge={class:"notification-row"},We=(0,o._)("div",{class:"notification-row"},[(0,o._)("span",{id:"comment"}," Accepté ! ")],-1);function Je(e,t,n,l,a,s){return(0,o.wg)(),(0,o.iD)("div",Pe,[(0,o._)("div",Ge,[(0,o._)("span",null,(0,i.zw)(n.notification.sujet_demande),1),(0,o._)("span",null,(0,i.zw)(n.notification.banque_name),1)]),We])}var Xe={name:"ClientNotificationListElement",props:{notification:{type:Object,required:!0}}};const Ke=(0,Re.Z)(Xe,[["render",Je]]);var Ye=Ke;const Qe={id:"demandListElement"},et={class:"demandRow"},tt={class:"demandRow"},nt=(0,o._)("br",null,null,-1),ot={class:"demandRow"},it=(0,o._)("span",null,"État :",-1),lt={id:"accept_count"},at={id:"pending_count"},st={id:"refuse_count"};function rt(e,t,n,l,a,s){const r=(0,o.up)("client-demand-detail");return(0,o.wg)(),(0,o.iD)("div",Qe,[(0,o._)("h3",null,(0,i.zw)(n.demand.sujet),1),(0,o._)("div",et,[(0,o._)("span",null," Acquisition : "+(0,i.zw)(n.demand.montant_bien)+" €",1),(0,o.Uk)(),(0,o._)("span",null," Apport : "+(0,i.zw)(n.demand.apport_personnel)+" €",1)]),(0,o._)("div",tt,[(0,o._)("span",null,(0,i.zw)(n.demand.commentaire),1)]),nt,(0,o._)("div",ot,[it,(0,o._)("span",lt,(0,i.zw)(n.demand.accepted),1),(0,o._)("span",at,(0,i.zw)(n.demand.pending),1),(0,o._)("span",st,(0,i.zw)(n.demand.refused),1)]),(0,o.Wm)(r,{propDemand:n.demand},null,8,["propDemand"])])}const ut={key:0,id:"modal-form",ref:"modalForm"},dt={id:"demandDetailForm"},mt={id:"demandDetailFormFields"},ct={class:"mb-3"},pt=(0,o._)("label",{for:"formSubject",class:"form-label"},"Sujet",-1),ft={class:"mb-3"},ht=(0,o._)("label",{for:"formNature",class:"form-label"},"Nature du projet ?",-1),_t=(0,o.uE)('<option value="">Choisissez la nature de votre projet</option><option value="Achat">Achat</option><option value="Construction">Construction</option><option value="Travaux">Travaux</option><option value="Autre">Autre</option>',5),vt=[_t],bt={class:"mb-3"},Dt=(0,o._)("label",{for:"formType",class:"form-label"},"Type de bien ?",-1),wt=(0,o.uE)('<option value="">Choisissez le type du bien</option><option value="Maison">Maison</option><option value="Appartement">Appartement</option><option value="Terrain">Terrain</option><option value="Autre">Autre</option>',5),yt=[wt],gt={class:"mb-3"},Ct=(0,o._)("label",{for:"formAge",class:"form-label"},"Age du bien ?",-1),At=(0,o._)("option",{value:""},"Choisissez l'âge du bien",-1),zt=(0,o._)("option",{value:"Ancien"},"Ancien",-1),Ft=(0,o._)("option",{value:"Neuf"},"Neuf",-1),xt=(0,o._)("option",{value:"Vente sur plan"},"Vente sur plan",-1),kt=[At,zt,Ft,xt],Vt={class:"mb-3"},jt=(0,o._)("label",{for:"formPurpose",class:"form-label"},"Usage du bien ?",-1),Et=(0,o.uE)('<option value="">Choisissez l&#39;usage du bien</option><option value="Résidence principale">Résidence principale</option><option value="Résidence secondaire">Résidence secondaire</option><option value="Investissement locatif">Investissement locatif</option><option value="Usage professionnel">Usage professionnel</option><option value="Usage mixte">Usage mixte</option><option value="Autre">Autre</option>',7),Ut=[Et],qt={class:"mb-3"},Tt=(0,o._)("label",{for:"formResearchStatus",class:"form-label"},"Ou en êtes vous dans votre recherche ?",-1),St=(0,o.uE)('<option value="">Renseigner où vous en êtes dans votre recherche</option><option value="En recherche">En recherche</option><option value="Vous vous préparez à faire une offre">Vous vous préparez à faire une offre</option><option value="Vous avez déjà fait une offre">Vous avez déjà fait une offre</option><option value="Vous pensez bientôt signer compromi">Vous pensez bientôt signer compromis</option><option value="Vous avez déjà signé un compromis">Vous avez déjà signé un compromis</option><option value="Autre">Autre</option>',7),Nt=[St],$t={class:"mb-3"},Rt=(0,o._)("label",{for:"formCountry",class:"form-label"},"Dans quel pays se situe le bien ?",-1),Lt={class:"mb-3"},Mt=(0,o._)("label",{for:"formCity",class:"form-label"},"Dans quelle ville se situe le bien ?",-1),It={class:"mb-3"},Zt=(0,o._)("label",{for:"formAcquisitionAmount",class:"form-label"},"Montant estimé de l'acquisition ?",-1),Ot={class:"mb-3"},Ht=(0,o._)("label",{for:"formTravauxAmount",class:"form-label"},"Montant estimé des travaux ?",-1),Bt={class:"mb-3"},Pt=(0,o._)("label",{for:"formNotaireAmount",class:"form-label"},"Frais de notaire ? (optionnel)",-1),Gt={class:"mb-3"},Wt=(0,o._)("label",{for:"formAloneGroup",class:"form-label"},"Comment empruntez-vous ?",-1),Jt=(0,o._)("option",{value:""},"Vous empruntez seul ? En groupe ? ",-1),Xt=(0,o._)("option",{value:"1"},"Seul",-1),Kt=(0,o._)("option",{value:"2"},"Avec un co-emprunteur",-1),Yt=(0,o._)("option",{value:"3"},"Autre",-1),Qt=[Jt,Xt,Kt,Yt],en={class:"mb-3"},tn=(0,o._)("label",{for:"formApport",class:"form-label"},"Votre apport personnel ?",-1),nn={class:"mb-3"},on=(0,o._)("label",{for:"formComment",class:"form-label"},"Commentaires sur le projet ? (optionnel)",-1),ln={class:"mb-3"},an=(0,o._)("label",{for:"formFileMultiple",class:"form-label"},"Vos Fichiers",-1);function sn(e,t,n,l,a,s){const r=(0,o.up)("ClientFileListCheckableElement"),u=(0,o.up)("client-new-file-form");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("button",{id:"detailButton",onClick:t[0]||(t[0]=()=>s.handleDisplay())},"Détails"),a.displayDetail?((0,o.wg)(),(0,o.iD)("div",ut,[(0,o._)("button",{id:"closeButton",onClick:t[1]||(t[1]=()=>s.handleDisplay())},"X"),(0,o._)("h2",null,"Détails de la demande "+(0,i.zw)(a.newDemand.subject),1),(0,o._)("form",dt,[(0,o._)("div",mt,[(0,o._)("div",ct,[pt,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formSubject","onUpdate:modelValue":t[2]||(t[2]=e=>a.newDemand.sujet=e),placeholder:"Trouvez un titre pour votre demande",required:""},null,512),[[U.nr,a.newDemand.sujet]])]),(0,o._)("div",ft,[ht,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formNature","onUpdate:modelValue":t[3]||(t[3]=e=>a.newDemand.nature=e),required:""},vt,512),[[U.bM,a.newDemand.nature]])]),(0,o._)("div",bt,[Dt,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formType","onUpdate:modelValue":t[4]||(t[4]=e=>a.newDemand.type=e),required:""},yt,512),[[U.bM,a.newDemand.type]])]),(0,o._)("div",gt,[Ct,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formAge","onUpdate:modelValue":t[5]||(t[5]=e=>a.newDemand.age=e),required:""},kt,512),[[U.bM,a.newDemand.age]])]),(0,o._)("div",Vt,[jt,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formPurpose","onUpdate:modelValue":t[6]||(t[6]=e=>a.newDemand.usage=e),required:""},Ut,512),[[U.bM,a.newDemand.usage]])]),(0,o._)("div",qt,[Tt,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formResearchStatus","onUpdate:modelValue":t[7]||(t[7]=e=>a.newDemand.status_recherche=e),required:""},Nt,512),[[U.bM,a.newDemand.status_recherche]])]),(0,o._)("div",$t,[Rt,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formCountry","onUpdate:modelValue":t[8]||(t[8]=e=>a.newDemand.pays=e),placeholder:"Renseignez le pays où se situe le bien",required:""},null,512),[[U.nr,a.newDemand.pays]])]),(0,o._)("div",Lt,[Mt,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formCity","onUpdate:modelValue":t[9]||(t[9]=e=>a.newDemand.ville=e),placeholder:"Renseignez la ville où se situe le bien",required:""},null,512),[[U.nr,a.newDemand.ville]])]),(0,o._)("div",It,[Zt,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formAcquisitionAmount","onUpdate:modelValue":t[10]||(t[10]=e=>a.newDemand.montant_bien=e),placeholder:"Renseignez la valeur estimée du bien",required:""},null,512),[[U.nr,a.newDemand.montant_bien]])]),(0,o._)("div",Ot,[Ht,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formTravauxAmount","onUpdate:modelValue":t[11]||(t[11]=e=>a.newDemand.montant_travaux=e),placeholder:"Renseignez la valeur estimée des travaux",required:""},null,512),[[U.nr,a.newDemand.montant_travaux]])]),(0,o._)("div",Bt,[Pt,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formNotaireAmount","onUpdate:modelValue":t[12]||(t[12]=e=>a.newDemand.frais_notaire=e),placeholder:"Renseignez les frais de notaires, si il y a"},null,512),[[U.nr,a.newDemand.frais_notaire]])]),(0,o._)("div",Gt,[Wt,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formAloneGroup","onUpdate:modelValue":t[13]||(t[13]=e=>a.newDemand.accompagnement=e),required:""},Qt,512),[[U.bM,a.newDemand.accompagnement]])]),(0,o._)("div",en,[tn,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formApport","onUpdate:modelValue":t[14]||(t[14]=e=>a.newDemand.apport_personnel=e),placeholder:"Renseignez votre apport dans l'acquisition",required:""},null,512),[[U.nr,a.newDemand.apport_personnel]])]),(0,o._)("div",nn,[on,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formComment","onUpdate:modelValue":t[15]||(t[15]=e=>a.newDemand.commentaire=e),placeholder:"Vous pouvez ajouter tout détail que vous pensez significant"},null,512),[[U.nr,a.newDemand.commentaire]])]),(0,o._)("div",ln,[an,(0,o._)("ul",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.userFiles,(e=>((0,o.wg)(),(0,o.j4)(r,{key:e.id_document,file:e},null,8,["file"])))),128))]),(0,o.Wm)(u)])]),(0,o._)("button",{type:"submit",class:"btn btn-primary",onClick:t[16]||(t[16]=e=>s.handleSubmit(e))},"Enregistrer les modifications"),(0,o._)("button",{type:"button",class:"btn btn-danger",onClick:t[17]||(t[17]=e=>s.handleDelete(e))},"Supprimer")])],512)):(0,o.kq)("",!0)])}var rn={name:"ClientDemandDetail",components:{ClientFileListCheckableElement:Me,ClientNewFileForm:Ie.Z},props:{propDemand:{type:Object,required:!0}},data(){return{newDemand:{},displayDetail:!1,userFiles:[]}},methods:{handleSubmit(e){if(""==this.newDemand.subject||""==this.newDemand.nature||""==this.newDemand.type||""==this.newDemand.age||""==this.newDemand.usage||""==this.newDemand.researchStatus||""==this.newDemand.country||""==this.newDemand.city||""==this.newDemand.acquisitionAmount||""==this.newDemand.aloneGroup||""==this.newDemand.apport)return;e.preventDefault();let t=["Document d'identité","Fiche de paie","Document médical","Justificatif de domicile"],n=[],o=[];for(let i=0;i<this.userFiles.length;i++)-1!=this.newDemand.files.findIndex((e=>e==this.userFiles[i].id_document))&&n.push(this.userFiles[i].type);for(let i=0;i<t.length;i++)-1==n.findIndex((e=>e==t[i]))&&o.push(t[i]);o.length>0&&!confirm("Attention ! Les fichiers suivants sont manquants : \n-"+o.join("\n-")+"\nVoulez-vous continuer ?")||fetch(this.api_url+"demande_client/updateDemande/"+this.newDemand.id_demande,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")},body:JSON.stringify(this.newDemand)}).then((e=>{if(e.ok)return e.json();throw new Error("Erreur lors de la mise à jour de la demande")})).then((e=>{console.log(e),this.displayDetail=!1,this.$notify({title:"Demande mise à jour",text:"La demande a bien été mise à jour",type:"success"})})).catch((e=>{console.log(e),this.$notify({title:"Erreur",text:e.message,type:"error"})}))},handleDelete(){fetch(this.api_url+"demande_client/deleteDemande/"+this.newDemand.id_demande,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}}).then((e=>{if(e.ok)return e.json();throw new Error("Erreur lors de la suppression de la demande")})).then((e=>{console.log(e),console.log("a"),this.displayDetail=!1,this.$notify({title:"Demande supprimée",text:"La demande a bien été supprimée",type:"success"}),console.log(this.$parent.$parent.userDemands),this.$parent.$parent.userDemands=this.$parent.$parent.userDemands.filter((e=>e.id_demande!=this.newDemand.id_demande)),console.log(this.$parent.$parent.userDemands)})).catch((e=>{console.log(e),this.$notify({title:"Erreur",text:e.message,type:"error"})}))},handleDisplay(){this.displayDetail=!this.displayDetail}},mounted(){fetch(this.api_url+"document/getAllDocuments",{method:"GET",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}}).then((e=>{if(e.ok)return e.json();if(401!=e.status)throw new Error("Une erreur est survenue, veuillez réessayer plus tard");this.$router.push("/login")})).then((e=>{console.log(e),this.userFiles=e,this.newDemand=this.propDemand})).catch((e=>{console.log(e),this.$notify({title:"Erreur",text:e.message,type:"error"})}))}};const un=(0,Re.Z)(rn,[["render",sn]]);var dn=un,mn={components:{ClientDemandDetail:dn},name:"ClientDemandsListElement",props:{demand:{type:Object,required:!0}}};const cn=(0,Re.Z)(mn,[["render",rt]]);var pn=cn;const fn={key:0,id:"modalFileList"};function hn(e,t,n,i,l,a){const s=(0,o.up)("client-file-list");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=()=>a.handleDisplay())},"Vos fichiers"),l.display?((0,o.wg)(),(0,o.iD)("div",fn,[(0,o._)("button",{id:"closeButton",onClick:t[1]||(t[1]=()=>a.handleDisplay())},"X"),(0,o.Wm)(s)])):(0,o.kq)("",!0)])}var _n=n(4057),vn={name:"ClientFileListModal",components:{ClientFileList:_n.Z},data(){return{display:!1}},methods:{handleDisplay(){this.display=!this.display}}};const bn=(0,Re.Z)(vn,[["render",hn]]);var Dn=bn,wn={name:"ClientHomeView",components:{HeaderComponent:Be.Z,ClientDemandForm:He,ClientNotificationListElement:Ye,ClientDemandsListElement:pn,ClientFileListModal:Dn},data(){return{userData:{},userNotifications:[],userDemands:[]}},methods:{fetchUserData(){fetch(this.api_url+"client/getClient",{headers:{"Content-Type":"application/json",authorization:localStorage.getItem("token")}}).then((e=>(401==e.status&&this.$router.push("/login"),e.json()))).then((e=>{console.log(e),this.userData=e;for(const t in this.userData)"date_birth"==t?this.userData[t]=this.userData[t].split("T")[0]:null==this.userData[t]&&(this.userData[t]="Non renseigné")}))},fetchUserNotifications(){fetch(this.api_url+"demande_client/getAllDemandesAccepted",{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}}).then((e=>(401==e.status&&this.$router.push("/login"),e.json()))).then((e=>{Array.isArray(e)?(console.log(e),this.userNotifications=e):this.userNotifications=[]}))},fetchUserDemands(){fetch(this.api_url+"demande_client/getAllDemandes",{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}}).then((e=>(401==e.status&&this.$router.push("/login"),e.json()))).then((e=>{console.log(e),this.userDemands=e,fetch(this.api_url+"demande_client/getAllStatutDemandes",{headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}}).then((e=>e.json())).then((e=>{for(let t=0;t<this.userDemands.length;t++)this.userDemands[t].accepted=e[t].accepted,this.userDemands[t].refused=e[t].refused,this.userDemands[t].pending=e[t].pending}))}))}},mounted(){console.log("Mounted"),this.fetchUserData(),this.fetchUserNotifications(),this.fetchUserDemands()}};const yn=(0,Re.Z)(wn,[["render",E]]);var gn=yn}}]);
//# sourceMappingURL=898.20fe5bf9.js.map
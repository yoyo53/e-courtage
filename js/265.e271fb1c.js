"use strict";(self["webpackChunkfront"]=self["webpackChunkfront"]||[]).push([[265],{9265:function(e,t,n){n.d(t,{Z:function(){return ue}});var o=n(3396),i=n(7139),l=n(9242);const a={key:0,id:"modal-form",ref:"modalForm"},s={id:"demandDetailForm"},r={id:"demandDetailFormFields"},u={class:"mb-3"},d=(0,o._)("label",{for:"formSubject",class:"form-label"},"Sujet",-1),m={class:"mb-3"},p=(0,o._)("label",{for:"formNature",class:"form-label"},"Nature du projet ?",-1),c=(0,o.uE)('<option value="">Choisissez la nature de votre projet</option><option value="Achat">Achat</option><option value="Construction">Construction</option><option value="Travaux">Travaux</option><option value="Autre">Autre</option>',5),f=[c],h={class:"mb-3"},b=(0,o._)("label",{for:"formType",class:"form-label"},"Type de bien ?",-1),v=(0,o.uE)('<option value="">Choisissez le type du bien</option><option value="Maison">Maison</option><option value="Appartement">Appartement</option><option value="Terrain">Terrain</option><option value="Autre">Autre</option>',5),_=[v],D={class:"mb-3"},y=(0,o._)("label",{for:"formAge",class:"form-label"},"Age du bien ?",-1),w=(0,o._)("option",{value:""},"Choisissez l'âge du bien",-1),g=(0,o._)("option",{value:"Ancien"},"Ancien",-1),A=(0,o._)("option",{value:"Neuf"},"Neuf",-1),C=(0,o._)("option",{value:"Vente sur plan"},"Vente sur plan",-1),F=[w,g,A,C],x={class:"mb-3"},k=(0,o._)("label",{for:"formPurpose",class:"form-label"},"Usage du bien ?",-1),V=(0,o.uE)('<option value="">Choisissez l&#39;usage du bien</option><option value="Résidence principale">Résidence principale</option><option value="Résidence secondaire">Résidence secondaire</option><option value="Investissement locatif">Investissement locatif</option><option value="Usage professionnel">Usage professionnel</option><option value="Usage mixte">Usage mixte</option><option value="Autre">Autre</option>',7),z=[V],q={class:"mb-3"},E=(0,o._)("label",{for:"formResearchStatus",class:"form-label"},"Ou en êtes vous dans votre recherche ?",-1),j=(0,o.uE)('<option value="">Renseigner où vous en êtes dans votre recherche</option><option value="En recherche">En recherche</option><option value="Vous vous préparez à faire une offre">Vous vous préparez à faire une offre</option><option value="Vous avez déjà fait une offre">Vous avez déjà fait une offre</option><option value="Vous pensez bientôt signer compromi">Vous pensez bientôt signer compromis</option><option value="Vous avez déjà signé un compromis">Vous avez déjà signé un compromis</option><option value="Autre">Autre</option>',7),U=[j],$={class:"mb-3"},T=(0,o._)("label",{for:"formCountry",class:"form-label"},"Dans quel pays se situe le bien ?",-1),S={class:"mb-3"},N=(0,o._)("label",{for:"formCity",class:"form-label"},"Dans quelle ville se situe le bien ?",-1),R={class:"mb-3"},M=(0,o._)("label",{for:"formAcquisitionAmount",class:"form-label"},"Montant estimé de l'acquisition ?",-1),I={class:"mb-3"},O=(0,o._)("label",{for:"formTravauxAmount",class:"form-label"},"Montant estimé des travaux ?",-1),Z={class:"mb-3"},L=(0,o._)("label",{for:"formNotaireAmount",class:"form-label"},"Frais de notaire ? (optionnel)",-1),B={class:"mb-3"},G=(0,o._)("label",{for:"formAloneGroup",class:"form-label"},"Comment empruntez-vous ?",-1),J=(0,o._)("option",{value:""},"Vous empruntez seul ? En groupe ? ",-1),H=(0,o._)("option",{value:"1"},"Seul",-1),P=(0,o._)("option",{value:"2"},"Avec un co-emprunteur",-1),X=(0,o._)("option",{value:"3"},"Autre",-1),K=[J,H,P,X],W={class:"mb-3"},Y=(0,o._)("label",{for:"formApport",class:"form-label"},"Votre apport personnel ?",-1),Q={class:"mb-3"},ee=(0,o._)("label",{for:"formComment",class:"form-label"},"Commentaires sur le projet ? (optionnel)",-1),te={class:"mb-3"},ne=(0,o._)("label",{for:"formFileMultiple",class:"form-label"},"Vos Fichiers",-1);function oe(e,t,n,c,v,w){const g=(0,o.up)("ClientFileListCheckableElement"),A=(0,o.up)("client-new-file-form");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("button",{id:"detailButton",onClick:t[0]||(t[0]=()=>w.handleDisplay())},"Détails"),v.displayDetail?((0,o.wg)(),(0,o.iD)("div",a,[(0,o._)("button",{id:"closeButton",onClick:t[1]||(t[1]=()=>w.handleDisplay())},"X"),(0,o._)("h2",null,"Détails de la demande "+(0,i.zw)(v.newDemand.subject),1),(0,o._)("form",s,[(0,o._)("div",r,[(0,o._)("div",u,[d,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formSubject","onUpdate:modelValue":t[2]||(t[2]=e=>v.newDemand.sujet=e),placeholder:"Trouvez un titre pour votre demande",required:""},null,512),[[l.nr,v.newDemand.sujet]])]),(0,o._)("div",m,[p,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formNature","onUpdate:modelValue":t[3]||(t[3]=e=>v.newDemand.nature=e),required:""},f,512),[[l.bM,v.newDemand.nature]])]),(0,o._)("div",h,[b,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formType","onUpdate:modelValue":t[4]||(t[4]=e=>v.newDemand.type=e),required:""},_,512),[[l.bM,v.newDemand.type]])]),(0,o._)("div",D,[y,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formAge","onUpdate:modelValue":t[5]||(t[5]=e=>v.newDemand.age=e),required:""},F,512),[[l.bM,v.newDemand.age]])]),(0,o._)("div",x,[k,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formPurpose","onUpdate:modelValue":t[6]||(t[6]=e=>v.newDemand.usage=e),required:""},z,512),[[l.bM,v.newDemand.usage]])]),(0,o._)("div",q,[E,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formResearchStatus","onUpdate:modelValue":t[7]||(t[7]=e=>v.newDemand.status_recherche=e),required:""},U,512),[[l.bM,v.newDemand.status_recherche]])]),(0,o._)("div",$,[T,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formCountry","onUpdate:modelValue":t[8]||(t[8]=e=>v.newDemand.pays=e),placeholder:"Renseignez le pays où se situe le bien",required:""},null,512),[[l.nr,v.newDemand.pays]])]),(0,o._)("div",S,[N,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formCity","onUpdate:modelValue":t[9]||(t[9]=e=>v.newDemand.ville=e),placeholder:"Renseignez la ville où se situe le bien",required:""},null,512),[[l.nr,v.newDemand.ville]])]),(0,o._)("div",R,[M,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formAcquisitionAmount","onUpdate:modelValue":t[10]||(t[10]=e=>v.newDemand.montant_bien=e),placeholder:"Renseignez la valeur estimée du bien",required:""},null,512),[[l.nr,v.newDemand.montant_bien]])]),(0,o._)("div",I,[O,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formTravauxAmount","onUpdate:modelValue":t[11]||(t[11]=e=>v.newDemand.montant_travaux=e),placeholder:"Renseignez la valeur estimée des travaux",required:""},null,512),[[l.nr,v.newDemand.montant_travaux]])]),(0,o._)("div",Z,[L,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formNotaireAmount","onUpdate:modelValue":t[12]||(t[12]=e=>v.newDemand.frais_notaire=e),placeholder:"Renseignez les frais de notaires, si il y a"},null,512),[[l.nr,v.newDemand.frais_notaire]])]),(0,o._)("div",B,[G,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formAloneGroup","onUpdate:modelValue":t[13]||(t[13]=e=>v.newDemand.accompagnement=e),required:""},K,512),[[l.bM,v.newDemand.accompagnement]])]),(0,o._)("div",W,[Y,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formApport","onUpdate:modelValue":t[14]||(t[14]=e=>v.newDemand.apport_personnel=e),placeholder:"Renseignez votre apport dans l'acquisition",required:""},null,512),[[l.nr,v.newDemand.apport_personnel]])]),(0,o._)("div",Q,[ee,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formComment","onUpdate:modelValue":t[15]||(t[15]=e=>v.newDemand.commentaire=e),placeholder:"Vous pouvez ajouter tout détail que vous pensez significant"},null,512),[[l.nr,v.newDemand.commentaire]])]),(0,o._)("div",te,[ne,(0,o._)("ul",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(v.userFiles,(e=>((0,o.wg)(),(0,o.j4)(g,{key:e.id_document,file:e},null,8,["file"])))),128))]),(0,o.Wm)(A)])]),(0,o._)("button",{type:"submit",class:"btn btn-primary",onClick:t[16]||(t[16]=e=>w.handleSubmit(e))},"Enregistrer les modifications"),(0,o._)("button",{type:"button",class:"btn btn-danger",onClick:t[17]||(t[17]=e=>w.handleDelete(e))},"Supprimer")])],512)):(0,o.kq)("",!0)])}n(7658);var ie=n(6231),le=n(1256),ae={name:"ClientDemandDetail",components:{ClientFileListCheckableElement:ie.Z,ClientNewFileForm:le.Z},props:{propDemand:{type:Object,required:!0}},data(){return{newDemand:{},displayDetail:!1,userFiles:[]}},methods:{handleSubmit(e){if(""==this.newDemand.subject||""==this.newDemand.nature||""==this.newDemand.type||""==this.newDemand.age||""==this.newDemand.usage||""==this.newDemand.researchStatus||""==this.newDemand.country||""==this.newDemand.city||""==this.newDemand.acquisitionAmount||""==this.newDemand.aloneGroup||""==this.newDemand.apport)return;e.preventDefault();let t=["Document d'identité","Fiche de paie","Document médical","Justificatif de domicile"],n=[],o=[];for(let i=0;i<this.userFiles.length;i++)-1!=this.newDemand.files.findIndex((e=>e==this.userFiles[i].id_document))&&n.push(this.userFiles[i].type);for(let i=0;i<t.length;i++)-1==n.findIndex((e=>e==t[i]))&&o.push(t[i]);o.length>0&&!confirm("Attention ! Les fichiers suivants sont manquants : \n-"+o.join("\n-")+"\nVoulez-vous continuer ?")||fetch(this.api_url+"demande_client/updateDemande/"+this.newDemand.id_demande,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")},body:JSON.stringify(this.newDemand)}).then((e=>{if(e.ok)return e.json();throw new Error("Erreur lors de la mise à jour de la demande")})).then((e=>{console.log(e),this.displayDetail=!1,this.$notify({title:"Demande mise à jour",text:"La demande a bien été mise à jour",type:"success"})})).catch((e=>{console.log(e),this.$notify({title:"Erreur",text:e.message,type:"error"})}))},handleDelete(){fetch(this.api_url+"demande_client/deleteDemande/"+this.newDemand.id_demande,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}}).then((e=>{if(e.ok)return e.json();throw new Error("Erreur lors de la suppression de la demande")})).then((e=>{console.log(e),this.$parent.$parent.userDemands=this.$parent.$parent.userDemands.filter((e=>e.id_demande!=this.newDemand.id_demande)),this.displayDetail=!1})).catch((e=>{console.log(e),this.$notify({title:"Erreur",text:e.message,type:"error"})}))},handleDisplay(){this.displayDetail=!this.displayDetail}},mounted(){fetch(this.api_url+"document/getAllDocuments",{method:"GET",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}}).then((e=>{if(e.ok)return e.json();if(401!=e.status)throw new Error("Une erreur est survenue, veuillez réessayer plus tard");this.$router.push("/login")})).then((e=>{console.log(e),this.userFiles=e,this.newDemand=this.propDemand})).catch((e=>{console.log(e),this.$notify({title:"Erreur",text:e.message,type:"error"})}))}},se=n(89);const re=(0,se.Z)(ae,[["render",oe]]);var ue=re},6231:function(e,t,n){n.d(t,{Z:function(){return c}});var o=n(3396),i=n(7139);const l={id:"checkableRow"},a=["id","name"],s=["for"],r=(0,o._)("br",null,null,-1);function u(e,t,n,u,d,m){return(0,o.wg)(),(0,o.iD)("div",l,[(0,o._)("input",{type:"checkbox",id:n.file.id_document,ref:n.file.id_document,name:n.file.id,value:"Bike",onChange:t[0]||(t[0]=e=>m.handleAddFile(e))},null,40,a),(0,o._)("label",{for:n.file.id},(0,i.zw)(n.file.nom_document)+" ["+(0,i.zw)(n.file.type)+"]",9,s),r])}n(7658);var d={name:"ClientFileListCheckableElement",props:{file:{type:Object,required:!0}},methods:{handleAddFile(e){e.target.checked?this.$parent.newDemand.files.push(this.file.id_document):this.$parent.newDemand.files=this.$parent.newDemand.files.filter((e=>e!==this.file.id_document)),console.log(this.$parent.newDemand.files)}},updated(){void 0==this.$parent.newDemand.files&&(this.$parent.newDemand.files=[]),this.$parent.newDemand.files.includes(this.file.id_document)?this.$refs[this.file.id_document].checked=!0:this.$refs[this.file.id_document].checked=!1},mounted(){void 0==this.$parent.newDemand.files&&(this.$parent.newDemand.files=[]),this.$parent.newDemand.files.includes(this.file.id_document)?this.$refs[this.file.id_document].checked=!0:this.$refs[this.file.id_document].checked=!1}},m=n(89);const p=(0,m.Z)(d,[["render",u]]);var c=p},1256:function(e,t,n){n.d(t,{Z:function(){return D}});var o=n(3396),i=n(9242);const l={key:0,id:"modal-file-form",ref:"modalForm"},a=(0,o._)("h2",null,"Nouveau document",-1),s={class:"mb-3"},r=(0,o._)("label",{for:"formFile",class:"form-label"},"Votre fichier",-1),u={class:"mb-3"},d=(0,o._)("label",{for:"formNameTitle",class:"form-label"},"Nom du fichier",-1),m={class:"mb-3"},p=(0,o._)("label",{for:"formDocType",class:"form-label"},"Genre",-1),c=(0,o.uE)('<option value="">Selectionnez le type du fichier</option><option value="Document d&#39;identité">Document d&#39;identité</option><option value="Fiche de paie">Fiche de paie</option><option value="Document médical">Document médical</option><option value="Justificatif de domicile">Justificatif de domicile</option><option value="Autre">Autre</option>',6),f=[c];function h(e,t,n,c,h,b){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("button",{type:"none",id:"openNFButton",onClick:t[0]||(t[0]=()=>b.handleDisplay())},"NOUVEAU DOCUMENT"),h.displayForm?((0,o.wg)(),(0,o.iD)("div",l,[(0,o._)("button",{id:"closeButton",onClick:t[1]||(t[1]=()=>b.handleDisplay())},"X"),a,(0,o._)("form",null,[(0,o._)("div",s,[r,(0,o._)("input",{class:"form-control",type:"file",id:"formFile",onChange:t[2]||(t[2]=e=>b.onFilesChange(e)),required:""},null,32)]),(0,o._)("div",u,[d,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formNameTitle","onUpdate:modelValue":t[3]||(t[3]=e=>h.name=e),placeholder:"Nom du fichier",maxlength:"30",required:""},null,512),[[i.nr,h.name]])]),(0,o._)("div",m,[p,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formDocType","onUpdate:modelValue":t[4]||(t[4]=e=>h.type=e)},f,512),[[i.bM,h.type]])]),(0,o._)("button",{type:"submit",class:"btn btn-success",onClick:t[5]||(t[5]=e=>b.handleSubmit(e))},"Envoyer"),(0,o._)("button",{type:"none",class:"btn btn-warning",onClick:t[6]||(t[6]=()=>b.handleDisplay())},"Annuler")])],512)):(0,o.kq)("",!0)])}n(7658);var b={name:"ClientNewFileForm",data(){return{name:"",file:null,displayForm:!1,type:""}},methods:{onFilesChange(e){this.file=e.target.files[0]},handleSubmit(e){if(""==this.name||null==this.file||""==this.type)return;e.preventDefault();let t=new FormData;t.append("file",this.file),t.append("nom_document",this.name),t.append("type",this.type);let n=new XMLHttpRequest;n.open("POST",this.api_url+"document/addDocument"),n.setRequestHeader("Authorization",localStorage.getItem("token")),n.send(t),n.onload=()=>{if(200==n.status){let e=JSON.parse(n.response);console.log("File sent"),console.log(e.id_document),this.$parent.userFiles.push({nom_document:this.name+"."+this.file.name.split(".").pop(),id_document:e.id_document,type:this.type}),this.name="",this.file=null,this.type="",this.displayForm=!1,this.$notify({group:"foo",title:"Succès",text:"Votre document a bien été envoyé",type:"success"})}else console.log("Error while sending file"),this.$notify({group:"foo",title:"Erreur",text:"Une erreur est survenue lors de l'envoi du document",type:"error"})}},handleDisplay(){console.log("display"),this.displayForm=!this.displayForm}}},v=n(89);const _=(0,v.Z)(b,[["render",h]]);var D=_}}]);
//# sourceMappingURL=265.e271fb1c.js.map
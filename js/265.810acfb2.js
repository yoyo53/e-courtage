"use strict";(self["webpackChunkfront"]=self["webpackChunkfront"]||[]).push([[265],{9265:function(e,n,t){t.d(n,{Z:function(){return ue}});var o=t(3396),i=t(7139),l=t(9242);const a={key:0,id:"modal-form",ref:"modalForm"},s={id:"demandDetailForm"},r={id:"demandDetailFormFields"},u={class:"mb-3"},d=(0,o._)("label",{for:"formSubject",class:"form-label"},"Sujet",-1),m={class:"mb-3"},p=(0,o._)("label",{for:"formNature",class:"form-label"},"Nature du projet ?",-1),c=(0,o.uE)('<option value="">Choisissez la nature de votre projet</option><option value="Achat">Achat</option><option value="Construction">Construction</option><option value="Travaux">Travaux</option><option value="Autre">Autre</option>',5),f=[c],h={class:"mb-3"},b=(0,o._)("label",{for:"formType",class:"form-label"},"Type de bien ?",-1),v=(0,o.uE)('<option value="">Choisissez le type du bien</option><option value="Maison">Maison</option><option value="Appartement">Appartement</option><option value="Terrain">Terrain</option><option value="Autre">Autre</option>',5),_=[v],D={class:"mb-3"},y=(0,o._)("label",{for:"formAge",class:"form-label"},"Age du bien ?",-1),w=(0,o._)("option",{value:""},"Choisissez l'âge du bien",-1),g=(0,o._)("option",{value:"Ancien"},"Ancien",-1),A=(0,o._)("option",{value:"Neuf"},"Neuf",-1),C=(0,o._)("option",{value:"Vente sur plan"},"Vente sur plan",-1),F=[w,g,A,C],k={class:"mb-3"},x=(0,o._)("label",{for:"formPurpose",class:"form-label"},"Usage du bien ?",-1),z=(0,o.uE)('<option value="">Choisissez l&#39;usage du bien</option><option value="Résidence principale">Résidence principale</option><option value="Résidence secondaire">Résidence secondaire</option><option value="Investissement locatif">Investissement locatif</option><option value="Usage professionnel">Usage professionnel</option><option value="Usage mixte">Usage mixte</option><option value="Autre">Autre</option>',7),V=[z],q={class:"mb-3"},j=(0,o._)("label",{for:"formResearchStatus",class:"form-label"},"Ou en êtes vous dans votre recherche ?",-1),E=(0,o.uE)('<option value="">Renseigner où vous en êtes dans votre recherche</option><option value="En recherche">En recherche</option><option value="Vous vous préparez à faire une offre">Vous vous préparez à faire une offre</option><option value="Vous avez déjà fait une offre">Vous avez déjà fait une offre</option><option value="Vous pensez bientôt signer compromi">Vous pensez bientôt signer compromis</option><option value="Vous avez déjà signé un compromis">Vous avez déjà signé un compromis</option><option value="Autre">Autre</option>',7),U=[E],$={class:"mb-3"},T=(0,o._)("label",{for:"formCountry",class:"form-label"},"Dans quel pays se situe le bien ?",-1),S={class:"mb-3"},N=(0,o._)("label",{for:"formCity",class:"form-label"},"Dans quelle ville se situe le bien ?",-1),R={class:"mb-3"},M=(0,o._)("label",{for:"formAcquisitionAmount",class:"form-label"},"Montant estimé de l'acquisition ?",-1),I={class:"mb-3"},O=(0,o._)("label",{for:"formTravauxAmount",class:"form-label"},"Montant estimé des travaux ?",-1),Z={class:"mb-3"},L=(0,o._)("label",{for:"formNotaireAmount",class:"form-label"},"Frais de notaire ? (optionnel)",-1),B={class:"mb-3"},G=(0,o._)("label",{for:"formAloneGroup",class:"form-label"},"Comment empruntez-vous ?",-1),J=(0,o._)("option",{value:""},"Vous empruntez seul ? En groupe ? ",-1),H=(0,o._)("option",{value:"1"},"Seul",-1),P=(0,o._)("option",{value:"2"},"Avec un co-emprunteur",-1),X=(0,o._)("option",{value:"3"},"Autre",-1),K=[J,H,P,X],W={class:"mb-3"},Y=(0,o._)("label",{for:"formApport",class:"form-label"},"Votre apport personnel ?",-1),Q={class:"mb-3"},ee=(0,o._)("label",{for:"formComment",class:"form-label"},"Commentaires sur le projet ? (optionnel)",-1),ne={class:"mb-3"},te=(0,o._)("label",{for:"formFileMultiple",class:"form-label"},"Vos Fichiers",-1);function oe(e,n,t,c,v,w){const g=(0,o.up)("ClientFileListCheckableElement"),A=(0,o.up)("client-new-file-form");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("button",{id:"detailButton",onClick:n[0]||(n[0]=()=>w.handleDisplay())},"Détails"),v.displayDetail?((0,o.wg)(),(0,o.iD)("div",a,[(0,o._)("button",{id:"closeButton",onClick:n[1]||(n[1]=()=>w.handleDisplay())},"X"),(0,o._)("h2",null,"Détails de la demande "+(0,i.zw)(v.newDemand.subject),1),(0,o._)("form",s,[(0,o._)("div",r,[(0,o._)("div",u,[d,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formSubject","onUpdate:modelValue":n[2]||(n[2]=e=>v.newDemand.sujet=e),placeholder:"Trouvez un titre pour votre demande",required:""},null,512),[[l.nr,v.newDemand.sujet]])]),(0,o._)("div",m,[p,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formNature","onUpdate:modelValue":n[3]||(n[3]=e=>v.newDemand.nature=e),required:""},f,512),[[l.bM,v.newDemand.nature]])]),(0,o._)("div",h,[b,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formType","onUpdate:modelValue":n[4]||(n[4]=e=>v.newDemand.type=e),required:""},_,512),[[l.bM,v.newDemand.type]])]),(0,o._)("div",D,[y,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formAge","onUpdate:modelValue":n[5]||(n[5]=e=>v.newDemand.age=e),required:""},F,512),[[l.bM,v.newDemand.age]])]),(0,o._)("div",k,[x,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formPurpose","onUpdate:modelValue":n[6]||(n[6]=e=>v.newDemand.usage=e),required:""},V,512),[[l.bM,v.newDemand.usage]])]),(0,o._)("div",q,[j,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formResearchStatus","onUpdate:modelValue":n[7]||(n[7]=e=>v.newDemand.status_recherche=e),required:""},U,512),[[l.bM,v.newDemand.status_recherche]])]),(0,o._)("div",$,[T,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formCountry","onUpdate:modelValue":n[8]||(n[8]=e=>v.newDemand.pays=e),placeholder:"Renseignez le pays où se situe le bien",required:""},null,512),[[l.nr,v.newDemand.pays]])]),(0,o._)("div",S,[N,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formCity","onUpdate:modelValue":n[9]||(n[9]=e=>v.newDemand.ville=e),placeholder:"Renseignez la ville où se situe le bien",required:""},null,512),[[l.nr,v.newDemand.ville]])]),(0,o._)("div",R,[M,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formAcquisitionAmount","onUpdate:modelValue":n[10]||(n[10]=e=>v.newDemand.montant_bien=e),placeholder:"Renseignez la valeur estimée du bien",required:""},null,512),[[l.nr,v.newDemand.montant_bien]])]),(0,o._)("div",I,[O,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formTravauxAmount","onUpdate:modelValue":n[11]||(n[11]=e=>v.newDemand.montant_travaux=e),placeholder:"Renseignez la valeur estimée des travaux",required:""},null,512),[[l.nr,v.newDemand.montant_travaux]])]),(0,o._)("div",Z,[L,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formNotaireAmount","onUpdate:modelValue":n[12]||(n[12]=e=>v.newDemand.frais_notaire=e),placeholder:"Renseignez les frais de notaires, si il y a"},null,512),[[l.nr,v.newDemand.frais_notaire]])]),(0,o._)("div",B,[G,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formAloneGroup","onUpdate:modelValue":n[13]||(n[13]=e=>v.newDemand.accompagnement=e),required:""},K,512),[[l.bM,v.newDemand.accompagnement]])]),(0,o._)("div",W,[Y,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formApport","onUpdate:modelValue":n[14]||(n[14]=e=>v.newDemand.apport_personnel=e),placeholder:"Renseignez votre apport dans l'acquisition",required:""},null,512),[[l.nr,v.newDemand.apport_personnel]])]),(0,o._)("div",Q,[ee,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formComment","onUpdate:modelValue":n[15]||(n[15]=e=>v.newDemand.commentaire=e),placeholder:"Vous pouvez ajouter tout détail que vous pensez significant"},null,512),[[l.nr,v.newDemand.commentaire]])]),(0,o._)("div",ne,[te,(0,o._)("ul",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(v.userFiles,(e=>((0,o.wg)(),(0,o.j4)(g,{key:e.id_document,file:e},null,8,["file"])))),128))]),(0,o.Wm)(A)])]),(0,o._)("button",{type:"submit",class:"btn btn-primary",onClick:n[16]||(n[16]=e=>w.handleSubmit(e))},"Enregistrer les modifications"),(0,o._)("button",{type:"button",class:"btn btn-danger",onClick:n[17]||(n[17]=e=>w.handleDelete(e))},"Supprimer")])],512)):(0,o.kq)("",!0)])}t(7658);var ie=t(6231),le=t(3209),ae={name:"ClientDemandDetail",components:{ClientFileListCheckableElement:ie.Z,ClientNewFileForm:le.Z},props:{propDemand:{type:Object,required:!0}},data(){return{newDemand:{},displayDetail:!1,userFiles:[]}},methods:{handleSubmit(e){if(""==this.newDemand.subject||""==this.newDemand.nature||""==this.newDemand.type||""==this.newDemand.age||""==this.newDemand.usage||""==this.newDemand.researchStatus||""==this.newDemand.country||""==this.newDemand.city||""==this.newDemand.acquisitionAmount||""==this.newDemand.aloneGroup||""==this.newDemand.apport)return;e.preventDefault();let n=["Document d'identité","Fiche de paie","Document médical","Justificatif de domicile"],t=[],o=[];for(let i=0;i<this.userFiles.length;i++)-1!=this.newDemand.files.findIndex((e=>e==this.userFiles[i].id_document))&&t.push(this.userFiles[i].type);for(let i=0;i<n.length;i++)-1==t.findIndex((e=>e==n[i]))&&o.push(n[i]);o.length>0&&!confirm("Attention ! Les fichiers suivants sont manquants : \n-"+o.join("\n-")+"\nVoulez-vous continuer ?")||fetch(this.api_url+"demande_client/updateDemande/"+this.newDemand.id_demande,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")},body:JSON.stringify(this.newDemand)}).then((e=>{if(e.ok)return e.json();throw new Error("Erreur lors de la mise à jour de la demande")})).then((e=>{console.log(e),this.displayDetail=!1,this.$notify({title:"Demande mise à jour",text:"La demande a bien été mise à jour",type:"success"})})).catch((e=>{console.log(e),this.$notify({title:"Erreur",text:e.message,type:"error"})}))},handleDelete(){fetch(this.api_url+"demande_client/deleteDemande/"+this.newDemand.id_demande,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}}).then((e=>{if(e.ok)return e.json();throw new Error("Erreur lors de la suppression de la demande")})).then((e=>{console.log(e),this.$parent.$parent.userDemands=this.$parent.$parent.userDemands.filter((e=>e.id_demande!=this.newDemand.id_demande)),this.displayDetail=!1})).catch((e=>{console.log(e),this.$notify({title:"Erreur",text:e.message,type:"error"})}))},handleDisplay(){this.displayDetail=!this.displayDetail}},mounted(){fetch(this.api_url+"document/getAllDocuments",{method:"GET",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}}).then((e=>{if(e.ok)return e.json();if(401!=e.status)throw new Error("Une erreur est survenue, veuillez réessayer plus tard");this.$router.push("/login")})).then((e=>{console.log(e),this.userFiles=e,this.newDemand=this.propDemand})).catch((e=>{console.log(e),this.$notify({title:"Erreur",text:e.message,type:"error"})}))}},se=t(89);const re=(0,se.Z)(ae,[["render",oe]]);var ue=re},6231:function(e,n,t){t.d(n,{Z:function(){return c}});var o=t(3396),i=t(7139);const l={id:"checkableRow"},a=["id","name"],s=["for"],r=(0,o._)("br",null,null,-1);function u(e,n,t,u,d,m){return(0,o.wg)(),(0,o.iD)("div",l,[(0,o._)("input",{type:"checkbox",id:t.file.id_document,ref:t.file.id_document,name:t.file.id,value:"Bike",onChange:n[0]||(n[0]=e=>m.handleAddFile(e))},null,40,a),(0,o._)("label",{for:t.file.id},(0,i.zw)(t.file.nom_document)+" ["+(0,i.zw)(t.file.type)+"]",9,s),r])}t(7658);var d={name:"ClientFileListCheckableElement",props:{file:{type:Object,required:!0}},methods:{handleAddFile(e){e.target.checked?this.$parent.newDemand.files.push(this.file.id_document):this.$parent.newDemand.files=this.$parent.newDemand.files.filter((e=>e!==this.file.id_document)),console.log(this.$parent.newDemand.files)}},updated(){void 0==this.$parent.newDemand.files&&(this.$parent.newDemand.files=[]),this.$parent.newDemand.files.includes(this.file.id_document)?this.$refs[this.file.id_document].checked=!0:this.$refs[this.file.id_document].checked=!1},mounted(){void 0==this.$parent.newDemand.files&&(this.$parent.newDemand.files=[]),this.$parent.newDemand.files.includes(this.file.id_document)?this.$refs[this.file.id_document].checked=!0:this.$refs[this.file.id_document].checked=!1}},m=t(89);const p=(0,m.Z)(d,[["render",u]]);var c=p},3209:function(e,n,t){t.d(n,{Z:function(){return D}});var o=t(3396),i=t(9242);const l={key:0,id:"modal-file-form",ref:"modalForm"},a=(0,o._)("h2",null,"Nouveau document",-1),s={class:"mb-3"},r=(0,o._)("label",{for:"formFile",class:"form-label"},"Votre fichier",-1),u={class:"mb-3"},d=(0,o._)("label",{for:"formNameTitle",class:"form-label"},"Nom du fichier",-1),m={class:"mb-3"},p=(0,o._)("label",{for:"formDocType",class:"form-label"},"Genre",-1),c=(0,o.uE)('<option value="">Selectionnez le type du fichier</option><option value="Document d&#39;identité">Document d&#39;identité</option><option value="Fiche de paie">Fiche de paie</option><option value="Document médical">Document médical</option><option value="Justificatif de domicile">Justificatif de domicile</option><option value="Autre">Autre</option>',6),f=[c];function h(e,n,t,c,h,b){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("button",{type:"none",id:"openNFButton",onClick:n[0]||(n[0]=()=>b.handleDisplay())},"NOUVEAU DOCUMENT"),h.displayForm?((0,o.wg)(),(0,o.iD)("div",l,[(0,o._)("button",{id:"closeButton",onClick:n[1]||(n[1]=()=>b.handleDisplay())},"X"),a,(0,o._)("form",null,[(0,o._)("div",s,[r,(0,o._)("input",{class:"form-control",type:"file",id:"formFile",onChange:n[2]||(n[2]=e=>b.onFilesChange(e)),required:""},null,32)]),(0,o._)("div",u,[d,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"formNameTitle","onUpdate:modelValue":n[3]||(n[3]=e=>h.name=e),placeholder:"Nom du fichier",maxlength:"30",required:""},null,512),[[i.nr,h.name]])]),(0,o._)("div",m,[p,(0,o.wy)((0,o._)("select",{class:"form-select","aria-label":"Default select example",id:"formDocType","onUpdate:modelValue":n[4]||(n[4]=e=>h.type=e)},f,512),[[i.bM,h.type]])]),(0,o._)("button",{type:"submit",class:"btn btn-success",onClick:n[5]||(n[5]=e=>b.handleSubmit(e))},"Envoyer"),(0,o._)("button",{type:"none",class:"btn btn-warning",onClick:n[6]||(n[6]=()=>b.handleDisplay())},"Annuler")])],512)):(0,o.kq)("",!0)])}t(7658);var b={name:"ClientNewFileForm",data(){return{name:"",file:null,displayForm:!1,type:""}},methods:{onFilesChange(e){this.file=e.target.files[0]},handleSubmit(e){if(""==this.name||null==this.file||""==this.type)return;e.preventDefault();let n=new FormData;n.append("file",this.file),n.append("nom_document",this.name),n.append("type",this.type);let t=new XMLHttpRequest;t.open("POST",this.api_url+"document/addDocument"),t.setRequestHeader("Authorization",localStorage.getItem("token")),t.send(n),t.onload=()=>{if(200==t.status){let e=JSON.parse(t.response);console.log("File sent"),console.log(e.id_document),this.$parent.userFiles.push({nom_document:this.name+"."+this.file.name.split(".").pop(),id_document:e.id_document,type:this.type}),this.name="",this.file=null,this.type="",this.displayForm=!1}else console.log("Error while sending file")}},handleDisplay(){console.log("display"),this.displayForm=!this.displayForm}}},v=t(89);const _=(0,v.Z)(b,[["render",h]]);var D=_}}]);
//# sourceMappingURL=265.810acfb2.js.map
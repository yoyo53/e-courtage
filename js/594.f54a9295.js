(self["webpackChunkfront"]=self["webpackChunkfront"]||[]).push([[594],{7045:function(e,l,o){var t=o(6339),n=o(3070);e.exports=function(e,l,o){return o.get&&t(o.get,l,{getter:!0}),o.set&&t(o.set,l,{setter:!0}),n.f(e,l,o)}},2062:function(e,l,o){"use strict";var t=o(9781),n=o(1702),i=o(7045),r=URLSearchParams.prototype,a=n(r.forEach);t&&!("size"in r)&&i(r,"size",{get:function(){var e=0;return a(this,(function(){e++})),e},configurable:!0,enumerable:!0})},3843:function(e,l,o){"use strict";o.d(l,{Z:function(){return b}});var t=o(3396),n=o(9242);const i={key:0,id:"modal-form",ref:"modalForm"},r=(0,t._)("h2",null,"Nouveau document",-1),a={class:"mb-3"},s=(0,t._)("label",{for:"formFile",class:"form-label"},"Votre fichier",-1),c={class:"mb-3"},m=(0,t._)("label",{for:"formNameTitle",class:"form-label"},"Nom du fichier",-1);function d(e,l,o,d,f,u){return(0,t.wg)(),(0,t.iD)("div",null,[(0,t._)("button",{type:"none",id:"openNFButton",onClick:l[0]||(l[0]=()=>u.handleDisplay())},"NOUVEAU DOCUMENT"),f.displayForm?((0,t.wg)(),(0,t.iD)("div",i,[(0,t._)("button",{id:"closeButton",onClick:l[1]||(l[1]=()=>u.handleDisplay())},"X"),r,(0,t._)("form",null,[(0,t._)("div",a,[s,(0,t._)("input",{class:"form-control",type:"file",id:"formFile",onChange:l[2]||(l[2]=e=>u.onFilesChange(e)),required:""},null,32)]),(0,t._)("div",c,[m,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",id:"formNameTitle","onUpdate:modelValue":l[3]||(l[3]=e=>f.name=e),required:""},null,512),[[n.nr,f.name]])]),(0,t._)("button",{type:"submit",class:"btn btn-success",onClick:l[4]||(l[4]=e=>u.handleSubmit(e))},"Envoyer"),(0,t._)("button",{type:"none",class:"btn btn-warning",onClick:l[5]||(l[5]=()=>u.handleDisplay())},"Annuler")])],512)):(0,t.kq)("",!0)])}o(7658);var f={name:"ClientNewFileForm",data(){return{name:"",file:null,displayForm:!1}},methods:{onFilesChange(e){this.file=e.target.files[0]},handleSubmit(e){if(""==this.name||null==this.file)return;e.preventDefault();let l=new FormData;l.append("file",this.file),l.append("nom_document",this.name);let o=new XMLHttpRequest;o.open("POST","https://e-courtage-back.fly.dev/document/addDocument"),o.setRequestHeader("Authorization",localStorage.getItem("token")),o.send(l),o.onload=()=>{if(200==o.status){let e=JSON.parse(o.response);console.log("File sent"),console.log(e.id_document),this.$parent.userFiles.push({nom_document:this.name+"."+this.file.name.split(".").pop(),id_document:e.id_document}),this.name="",this.file=null,this.displayForm=!1}else console.log("Error while sending file")}},handleDisplay(){console.log("display"),this.displayForm=!this.displayForm}}},u=o(89);const p=(0,u.Z)(f,[["render",d]]);var b=p},8594:function(e,l,o){"use strict";o.r(l),o.d(l,{default:function(){return w}});var t=o(3396),n=o(7139);const i={id:"topDog"},r=(0,t.uE)('<form id="profileForm"><h2>Profil</h2><div class="fields"><div class="mb-3 profilePageField"><label for="formName" class="form-label">Nom</label><input type="text" class="form-control" id="formName"></div><div class="mb-3 profilePageField"><label for="formFirstName" class="form-label">Prénom</label><input type="text" class="form-control" id="formFirstName"></div><div class="mb-3 profilePageField"><label for="formEmail" class="form-label">Email</label><input type="text" class="form-control" id="formEmail"></div><div class="mb-3 profilePageField"><label for="formGenre" class="form-label">Genre</label><input type="text" class="form-control" id="formGenre"></div><div class="mb-3 profilePageField"><label for="formBirthDate" class="form-label">Date de naissance</label><input type="text" class="form-control" id="formBirthDate"></div><div class="mb-3 profilePageField"><label for="formTelephone" class="form-label">Telephone</label><input type="text" class="form-control" id="formTelephone"></div><div class="mb-3 profilePageField"><label for="formCountry" class="form-label">Pays</label><input type="text" class="form-control" id="formCountry"></div><div class="mb-3 profilePageField"><label for="formCity" class="form-label">Ville</label><input type="text" class="form-control" id="formCity"></div><div class="mb-3 profilePageField"><label for="formAddress" class="form-label">Adresse</label><input type="text" class="form-control" id="formAddress"></div><div class="mb-3 profilePageField"><label for="formHousingStatus" class="form-label">Statut immobilier</label><input type="text" class="form-control" id="formHousingStatus"></div><div class="mb-3 profilePageField"><label for="formWorkStatus" class="form-label">Situation professionnelle</label><input type="text" class="form-control" id="formWorkStatus"></div><div class="mb-3 profilePageField"><label for="formWorkContract" class="form-label">Contrat</label><input type="text" class="form-control" id="formWorkContract"></div><div class="mb-3 profilePageField"><label for="formWorkLength" class="form-label">En poste depuis</label><input type="text" class="form-control" id="formWorkLength"></div><div class="mb-3 profilePageField"><label for="formMainBank" class="form-label">Banque principale</label><input type="text" class="form-control" id="formMainBank"></div><div class="mb-3 profilePageField"><label for="formFamilyStatus" class="form-label">Situation familiale</label><input type="text" class="form-control" id="formFamilyStatus"></div><div class="mb-3 profilePageField"><label for="formNationality" class="form-label">Nationalité</label><input type="text" class="form-control" id="formNationality"></div><div class="mb-3 profilePageField"><label for="formMonthlyRevenue" class="form-label">Revenu mensuel</label><input type="text" class="form-control" id="formMonthlyRevenue"></div><div class="mb-3 profilePageField"><label for="formAnnualPrime" class="form-label">Prime annuelle (Optionnel)</label><input type="text" class="form-control" id="formAnnualPrime"></div><div class="mb-3 profilePageField"><label for="formCurrentRent" class="form-label">Loyer Actuel</label><input type="text" class="form-control" id="formCurrentRent"></div></div><button type="submit" class="btn btn-primary" id="saveButton">Mettre à jour</button></form>',1),a={id:"filesList"},s=(0,t._)("h2",{style:{"margin-bottom":"30px"}},"Vos fichiers",-1),c={class:"list-group"},m={class:"fileRow-text"},d={class:"fileRow-buttons"},f=["onClick"],u=["onClick"],p=["onClick"];function b(e,l,o,b,h,g){const v=(0,t.up)("HeaderComponent"),y=(0,t.up)("client-new-file-form");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t.Wm)(v),(0,t._)("div",i,[r,(0,t._)("div",a,[s,(0,t._)("ul",c,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(h.userFiles,(e=>((0,t.wg)(),(0,t.iD)("li",{class:"fileRow list-group-item",key:e.name},[(0,t._)("div",m,(0,n.zw)(e.id_document)+" - "+(0,n.zw)(e.nom_document),1),(0,t._)("div",d,[(0,t._)("button",{class:"btn btn-success fileRowButton",onClick:()=>g.handleDownload(e.id_document,e.nom_document)},"Télécharger",8,f),(0,t._)("button",{class:"btn btn-light fileRowButton",onClick:()=>g.handleUpdate(e.id_document)},"Remplacer",8,u),(0,t._)("button",{class:"btn btn-danger fileRowButton",onClick:()=>g.handleDelete(e.id_document)},"Supprimer",8,p)])])))),128))]),(0,t.Wm)(y)])])])}o(2062);var h=o(3216),g=o(3843),v={components:{HeaderComponent:h.Z,ClientNewFileForm:g.Z},data(){return{userFiles:[]}},methods:{handleDownload(e,l){console.log(e),fetch("https://e-courtage-back.fly.dev/document/downloadDocument/"+e,{method:"GET",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}}).then((e=>{if(e.ok)return e.blob();throw new Error("Something went wrong")})).then((e=>{console.log(e);const o=window.URL.createObjectURL(new Blob([e])),t=document.createElement("a");t.href=o,t.setAttribute("download",l),document.body.appendChild(t),t.click()}))},handleUpdate(e){console.log(e);const l=document.createElement("input");l.type="file",l.ref="file",l.click(),l.onchange=()=>{const o=new FormData;console.log(l),o.append("file",l.files[0]);let t=new XMLHttpRequest;t.open("PATCH","https://e-courtage-back.fly.dev/document/updateDocument/"+e,!0),t.setRequestHeader("Authorization",localStorage.getItem("token")),t.send(o),t.onload=function(){200==t.status?console.log("File uploaded"):console.log("Error "+t.status+" occurred when trying to upload your file.")}}},handleDelete(e){console.log(e),fetch("https://e-courtage-back.fly.dev/document/deleteDocument/"+e,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}}).then((e=>{if(e.ok)return e.json();throw new Error("Something went wrong")})).then((l=>{console.log(l),this.userFiles=this.userFiles.filter((l=>l.id_document!==e))}))},fetchUserFiles(){fetch("https://e-courtage-back.fly.dev/document/getAllDocuments",{method:"GET",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}}).then((e=>{if(e.ok)return e.json();throw new Error("Something went wrong")})).then((e=>{console.log(e),this.userFiles=e})).catch((e=>{console.log(e),alert("Une erreur est survenue, veuillez réessayer plus tard")}))}},mounted(){this.fetchUserFiles()}},y=o(89);const F=(0,y.Z)(v,[["render",b]]);var w=F}}]);
//# sourceMappingURL=594.f54a9295.js.map